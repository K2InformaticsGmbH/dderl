<html>
<head>
	<meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>SlickGrid in Dialog</title>

    <link rel="stylesheet" href="../static/styles/dderl.css" type="text/css"/>
</head>

<body>
    <script src="http://code.jquery.com/jquery-1.9.1.js"></script>
	<script src="http://code.jquery.com/ui/1.10.1/jquery-ui.js"></script>

    <script src="../static/slickgrid/lib/jquery.event.drag-2.0.min.js"></script>
    <script src="../static/slickgrid/slick.core.js"></script>
    <script src="../static/slickgrid/slick.grid.js"></script>
    <script src="../static/slickgrid/slick.formatters.js"></script>
    <script src="../static/slickgrid/slick.editors.js"></script>
    <script src="../static/slickgrid/slick.dataview.js"></script>
    <script src="../static/slickgrid/plugins/slick.cellrangedecorator.js"></script>
    <script src="../static/slickgrid/plugins/slick.cellrangeselector.js"></script>
    <script src="../static/slickgrid/plugins/slick.cellrowcolselectionmodel.js"></script>
    <script src="../static/scripts/jquery.contextMenu.js"></script>
    <script src="../static/scripts/jquery.jscrollpane.min.js"></script>
    <script src="../static/scripts/dderl.js"></script>
    <script src="../static/scripts/dderl.table.js"></script>
    <script src="../static/scripts/dderl.sql.js"></script>

    <!-- iframe id='body' style='width:100px; height:100px'></iframe -->
    <script language="javascript">
        $(document).ready(function()
        {
//            var dlg = show_dlg();
//            var columns = new Array();
//            for(var cl = 30; cl > 0; --cl)
//               columns[columns.length] = ("col" + cl);
//            dlg.table("setColumns", columns);
//
//            asyncRowBuilder(dlg, columns, 30);

            show_sql_edit();
        });

        function asyncRowBuilder(dlg, columns, count) {
            if(count < 0) return;

            var rows = new Array();
            //for (var i=5;i>0; --i) {
                var row = new Array();
                for(var j=0;j<columns.length; ++j) {
                    row[j] = randomString(j*5);
                }
                rows[rows.length] = row;
            //}
            dlg.table("appendRows", rows);
            setTimeout(function() {
                asyncRowBuilder(dlg, columns, count-1);
            }, 1);
        }

        function show_dlg() {
            return $('<div>')
                    .appendTo(document.body)
                    .table({
                        autoOpen    : false,
                        title       : "Simple Dialog",
                        dderlSession: 1234,
                        dderlAdapter: 'imem',
                    })
                    .table('open');
        }

        function show_sql_edit() {
            var dlg = $('<div>')
                .appendTo(document.body)
                .sql({
                    autoOpen    : false,
                    title       : "Simple Editor",
                    cmdFlat     : SAMPLE_SQL_FLAT,
                    cmdPretty   : SAMPLE_SQL_PRETTY,
                })
                .sql('open');
        }

        function randomString(idx) {
        	var chars = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz";
        	var string_length = 8;
        	var randomstring = '';
        	for (var i=0; i<Math.floor((Math.random()*idx)+1); i++) {
        		var rnum = Math.floor(Math.random() * chars.length);
        		randomstring += chars.substring(rnum,rnum+1);
        	}
        	return randomstring;
        }

  var SAMPLE_SQL_FLAT = 'select /*+036*/ NULL as ROW_ID_S , BDETAIL6.ROWID as ROW_ID_M , BD_UMSGGRPID as MSGID , to_char ( BD_DATESUBMIT , \'DD.MM.YYYY HH24:MI:SS\' ) as SUBMITTIME , to_char ( BD_DATEEXPIRE , \'DD.MM.YYYY HH24:MI:SS\' ) as EXPIRETIME , to_char ( BD_DATEDELIVERY , \'DD.MM.YYYY HH24:MI:SS\' ) as RECTIME , BD_MSISDN_A as SENDER , BD_MSISDN_B as RECEIVER , BD_MSGSIZE as MSGLEN , nvl ( MMSCCRT_LANG01 , BD_CDRRECTYPE ) as TYPE , nvl ( MMSCCRT_VALUE1 , BD_CDRRECTYPE ) as TYPE_TT1 , nvl ( MMSCCRT_VALUE2 , BD_CDRRECTYPE ) as TYPE_TT2 , decode ( BD_MSGTYPE , 01 , \'Y\' , 012 , \'Y\' , \'N\' ) as ISDELIV , nvl ( MMSCET_LANG02 , BD_EVENTDISP ) as EVENTDISP_STATCODE , nvl ( MMSCMT_LANG02 , BD_MSGTYPE ) as MSGTYPE_ERRCODE , nvl ( MMSCET_VALUE2 , BD_EVENTDISP ) as EVENTDISP_TT , nvl ( MMSCMT_VALUE2 , BD_MSGTYPE ) as MSGTYPE_TT , \'MMS\' as ROWTYPE , to_char ( BD_DATETIME , \'DD.MM.YYYY HH24:MI:SS\' ) as DATETIM from BDETAIL6 , MMSC_CDRRECTYPE , MMSC_EVENTDISPTYPE , MMSC_MSGTYPE where BD_CDRRECTYPE = MMSCCRT_ID and ltrim ( to_char ( BD_EVENTDISP ) ) = MMSCET_ID and ltrim ( to_char ( BD_MSGTYPE ) ) = MMSCMT_ID and BD_UMSGGRPID = \'mj78yk7r307fga5a01\' and BD_MSISDN_B = \'41796187332\' and BD_DATETIME >= to_date ( \'19.06.12 11:15:09\' , \'DD.MM.YY HH24:MI:SS\' ) - 14 and BD_DATETIME <= to_date ( \'19.06.12 11:15:09\' , \'DD.MM.YY HH24:MI:SS\' ) + 14 order by BD_DATETIME , nvl ( BD_DATEDELIVERY , BD_DATETIME ) , BD_MSGTYPE';

  var SAMPLE_SQL_PRETTY = 'select\n'
+'    /*+036*/\n'
+'        NULL as ROW_ID_S gggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggggg\n'
+'        ,\n'
+'        BDETAIL6.ROWID as ROW_ID_M\n'
+'        ,\n'
+'        BD_UMSGGRPID as MSGID\n'
+'        ,\n'
+'            to_char\n'
+'                (\n'
+'                    BD_DATESUBMIT\n'
+'                    ,\n'
+'                    \'DD.MM.YYYY HH24:MI:SS\'\n'
+'                ) as SUBMITTIME\n'
+'        ,\n'
+'            to_char\n'
+'                (\n'
+'                    BD_DATEEXPIRE\n'
+'                    ,\n'
+'                    \'DD.MM.YYYY HH24:MI:SS\'\n'
+'                ) as EXPIRETIME\n'
+'        ,\n'
+'            to_char\n'
+'                (\n'
+'                    BD_DATEDELIVERY\n'
+'                    ,\n'
+'                    \'DD.MM.YYYY HH24:MI:SS\'\n'
+'                ) as RECTIME\n'
+'        ,\n'
+'        BD_MSISDN_A as SENDER\n'
+'        ,\n'
+'        BD_MSISDN_B as RECEIVER\n'
+'        ,\n'
+'        BD_MSGSIZE as MSGLEN\n'
+'        ,\n'
+'            nvl\n'
+'                (\n'
+'                    MMSCCRT_LANG01\n'
+'                    ,\n'
+'                    BD_CDRRECTYPE\n'
+'                ) as TYPE\n'
+'        ,\n'
+'            nvl\n'
+'                (\n'
+'                    MMSCCRT_VALUE1\n'
+'                    ,\n'
+'                    BD_CDRRECTYPE\n'
+'                ) as TYPE_TT1\n'
+'        ,\n'
+'            nvl\n'
+'                (\n'
+'                    MMSCCRT_VALUE2\n'
+'                    ,\n'
+'                    BD_CDRRECTYPE\n'
+'                ) as TYPE_TT2\n'
+'        ,\n'
+'            decode\n'
+'                (\n'
+'                    BD_MSGTYPE\n'
+'                    ,\n'
+'                    01\n'
+'                    ,\n'
+'                    \'Y\'\n'
+'                    ,\n'
+'                    012\n'
+'                    ,\n'
+'                    \'Y\'\n'
+'                    ,\n'
+'                    \'N\'\n'
+'                ) as ISDELIV\n'
+'        ,\n'
+'            nvl\n'
+'                (\n'
+'                    MMSCET_LANG02\n'
+'                    ,\n'
+'                    BD_EVENTDISP\n'
+'                ) as EVENTDISP_STATCODE\n'
+'        ,\n'
+'            nvl\n'
+'                (\n'
+'                    MMSCMT_LANG02\n'
+'                    ,\n'
+'                    BD_MSGTYPE\n'
+'                ) as MSGTYPE_ERRCODE\n'
+'        ,\n'
+'            nvl\n'
+'                (\n'
+'                    MMSCET_VALUE2\n'
+'                    ,\n'
+'                    BD_EVENTDISP\n'
+'                ) as EVENTDISP_TT\n'
+'        ,\n'
+'            nvl\n'
+'                (\n'
+'                    MMSCMT_VALUE2\n'
+'                    ,\n'
+'                    BD_MSGTYPE\n'
+'                ) as MSGTYPE_TT\n'
+'        ,\n'
+'        \'MMS\' as ROWTYPE\n'
+'        ,\n'
+'            to_char\n'
+'                (\n'
+'                    BD_DATETIME\n'
+'                    ,\n'
+'                    \'DD.MM.YYYY HH24:MI:SS\'\n'
+'                ) as DATETIM\n'
+'    from\n'
+'        BDETAIL6\n'
+'        ,\n'
+'        MMSC_CDRRECTYPE\n'
+'        ,\n'
+'        MMSC_EVENTDISPTYPE\n'
+'        ,\n'
+'        MMSC_MSGTYPE\n'
+'    where\n'
+'            BD_CDRRECTYPE\n'
+'            =\n'
+'            MMSCCRT_ID\n'
+'        and\n'
+'                ltrim\n'
+'                    (\n'
+'                            to_char\n'
+'                                (\n'
+'                                    BD_EVENTDISP\n'
+'                                )\n'
+'                    )\n'
+'            =\n'
+'            MMSCET_ID\n'
+'        and\n'
+'                ltrim\n'
+'                    (\n'
+'                            to_char\n'
+'                                (\n'
+'                                    BD_MSGTYPE\n'
+'                                )\n'
+'                    )\n'
+'            =\n'
+'            MMSCMT_ID\n'
+'        and\n'
+'            BD_UMSGGRPID\n'
+'            =\n'
+'            \'mj78yk7r307fga5a01\'\n'
+'        and\n'
+'            BD_MSISDN_B\n'
+'            =\n'
+'            \'41796187332\'\n'
+'        and\n'
+'            BD_DATETIME\n'
+'            >=\n'
+'                    to_date\n'
+'                        (\n'
+'                            \'19.06.12 11:15:09\'\n'
+'                            ,\n'
+'                            \'DD.MM.YY HH24:MI:SS\'\n'
+'                        )\n'
+'                -\n'
+'                14\n'
+'        and\n'
+'            BD_DATETIME\n'
+'            <=\n'
+'                    to_date\n'
+'                        (\n'
+'                            \'19.06.12 11:15:09\'\n'
+'                            ,\n'
+'                            \'DD.MM.YY HH24:MI:SS\'\n'
+'                        )\n'
+'                +\n'
+'                14\n'
+'    order by\n'
+'        BD_DATETIME\n'
+'        ,\n'
+'            nvl\n'
+'                (\n'
+'                    BD_DATEDELIVERY\n'
+'                    ,\n'
+'                    BD_DATETIME\n'
+'                )\n'
+'        ,\n'
+'        BD_MSGTYPE\n';
        
    </script>
</body>

</html>

